# Inter-Agent Communication Format Guidelines

## Overview

This document defines the standard formats and protocols for communication between Claude Code agents. Proper format selection ensures efficient data exchange, maintainability, and clarity across the development pipeline.

## File Numbering System

### Format: PPP-SSS-descriptive-name.ext

- **PPP** (Phase Number): 000-999
  - 000: Initialization/Setup
  - 001: Early Architecture
  - 002: Interaction Mapping
  - 003: Deep Architecture
  - 004: Implementation
  - 005: Verification
  - 006: Fixes
  - 999: Meta/Status

- **SSS** (Step within Phase): 001-999
  - Sequential numbering within each phase
  - Allows for insertion of intermediate steps

- **descriptive-name**: Clear, hyphenated description
  - Use lowercase
  - Separate words with hyphens
  - Be specific but concise

### Examples:
```
000-001-task-description.md
001-002-early-architecture.md
002-002-interactions.json
002-003-interactions-readable.md
003-003-architecture-spec.yaml
999-001-session-status.md
```

## Agent Signature Requirements

### Every Agent Must Sign Their Work

All agents must include a signature in every file they create or significantly modify. This ensures traceability and accountability.

#### Standard Signature Format:

**For Markdown Files:**
```markdown
ðŸ“‹ Prepared by [AGENT-NAME] on [YYYY-MM-DD HH:MM]
Session: [session_id]
Purpose: [Brief description]
Phase: [PPP]
---
```

**For Code Files:**
```javascript
// Generated by [AGENT-NAME] - [YYYY-MM-DD HH:MM]
// Session: [session_id] | Phase: [PPP]
// Purpose: [Brief description]
```

**For JSON Files:**
```json
{
  "_metadata": {
    "agent": "agent-name",
    "timestamp": "ISO-8601",
    "session": "session_id",
    "phase": "PPP",
    "purpose": "description"
  },
  ...
}
```

**For YAML Files:**
```yaml
# Generated by [AGENT-NAME] - [YYYY-MM-DD HH:MM]
metadata:
  agent: agent-name
  timestamp: ISO-8601
  session: session_id
  phase: PPP
  purpose: description
```

## Format Selection Guidelines

### 1. Markdown (.md)

**Use for:**
- Human-readable documentation
- Task descriptions and instructions
- Architecture overviews and explanations
- Status reports and summaries
- Implementation logs
- Any content primarily for human consumption

**Structure:**
```markdown
ðŸ“‹ Prepared by [AGENT] on [TIMESTAMP]
Session: [ID]
Purpose: [PURPOSE]
Phase: [PPP]
---

# Title

## Section
Content with clear formatting for readability
```

**Examples:**
- `000-001-task-description.md`
- `001-002-early-architecture.md`
- `004-002-implementation-log.md`
- `999-001-session-status.md`

### 2. JSON (.json)

**Use for:**
- Structured data exchange between agents
- Interaction mappings
- Verification results
- Session metadata
- Agent handoff logs
- Any data that needs programmatic parsing

**Structure:**
```json
{
  "_metadata": {
    "agent": "string",
    "timestamp": "ISO-8601",
    "session": "string",
    "phase": "string",
    "purpose": "string"
  },
  "data": {
    // Structured content
  }
}
```

**Examples:**
- `000-002-session-metadata.json`
- `002-002-interactions.json`
- `005-003-verification-results.json`
- `999-002-agent-handoffs.json`

### 3. YAML (.yaml)

**Use for:**
- Configuration specifications
- Architecture specifications
- Workflow definitions
- Complex nested structures that need readability
- Settings and parameters

**Structure:**
```yaml
# Generated by [AGENT] - [TIMESTAMP]
metadata:
  agent: string
  timestamp: ISO-8601
  session: string
  phase: string
  purpose: string

specification:
  # Structured content with clear hierarchy
```

**Examples:**
- `003-003-architecture-spec.yaml`
- `workflow-config.yaml`
- `deployment-spec.yaml`

### 4. Code Comments

**Use for:**
- In-file agent signatures
- MVP shortcuts documentation
- TODO/FIXME markers
- Inline documentation
- Technical debt markers

**Format Examples:**

```javascript
// Generated by QUICK-DEVELOPER - 2024-01-15 10:30
// Session: 1501_2024_01 | Phase: 004

// MVP: Hardcoded value - TODO: Use configuration
const API_URL = 'http://localhost:3000';

// HACK: Synchronous for speed - PROPER SOLUTION: Use async/await
// TECH DEBT: O(nÂ²) algorithm - UPGRADE PATH: Use hash map for O(n)

/* MVP IMPLEMENTATION - Not Production Ready
 * Shortcuts taken:
 * 1. No input validation - Add before production
 * 2. Hardcoded credentials - Use env vars
 * Technical debt score: Medium
 */
```

## Communication Patterns

### 1. Task Assignment (Manager â†’ Worker)

**Format:** Markdown
**Naming:** `PPP-001-[agent]-task.md`

```markdown
ðŸ“‹ Prepared by MVP-MANAGER on 2024-01-15 10:00
Session: 1501_2024_01
Purpose: Task assignment for [AGENT]
Phase: PPP
---

## Task: [Clear description]

### Context
[Previous work completed, current state]

### Requirements
1. [Specific requirement]
2. [Specific requirement]

### Input Files
- `PPP-NNN-filename.ext` - Description

### Expected Outputs
- `PPP-NNN-output.ext` - What should be in it

### Constraints
- Time: [if applicable]
- Scope: [MVP-specific limitations]
```

### 2. Work Product (Worker â†’ Manager)

**Primary Format:** Depends on agent type
- Architects: Markdown + YAML
- Mappers: JSON + Markdown
- Developers: Code files + Markdown log

**All must include:** Agent signature

### 3. Verification Results (Reviewer â†’ Manager)

**Format:** JSON
**Naming:** `005-003-verification-results.json`

```json
{
  "_metadata": {
    "agent": "interaction-mapper",
    "timestamp": "2024-01-15T11:00:00Z",
    "session": "1501_2024_01",
    "phase": "005",
    "purpose": "Verification results"
  },
  "results": {
    "status": "pass|fail|partial",
    "items_checked": 20,
    "items_passed": 18,
    "items_failed": 2,
    "details": [...]
  }
}
```

## Best Practices

### 1. Dual-Format Strategy

When data needs both human and machine consumption:
- Create JSON/YAML for machines (primary)
- Create Markdown for humans (secondary)
- Link them with consistent numbering

Example:
- `002-002-interactions.json` (machine-readable)
- `002-003-interactions-readable.md` (human-readable)

### 2. Metadata Consistency

Always include:
- Agent identifier
- Timestamp (ISO-8601 for JSON/YAML, readable for Markdown)
- Session ID
- Phase number
- Purpose/description

### 3. Format Migration

When converting between formats:
- Preserve all metadata
- Maintain data fidelity
- Document any lossy transformations
- Keep both versions if both are needed

### 4. Error Handling

If format requirements conflict:
1. Prioritize machine-readability for data exchange
2. Add human-readable companion files
3. Document format choices in session status
4. Never mix formats in a single file

## Session Directory Structure

```
project/internal/DDMM_YYYY_NN/
â”œâ”€â”€ 000-001-task-description.md
â”œâ”€â”€ 000-002-session-metadata.json
â”œâ”€â”€ 001-001-architect-task.md
â”œâ”€â”€ 001-002-early-architecture.md
â”œâ”€â”€ 002-001-mapper-task.md
â”œâ”€â”€ 002-002-interactions.json
â”œâ”€â”€ 002-003-interactions-readable.md
â”œâ”€â”€ 003-001-architect-deep-task.md
â”œâ”€â”€ 003-002-architecture.md
â”œâ”€â”€ 003-003-architecture-spec.yaml
â”œâ”€â”€ 004-001-developer-task.md
â”œâ”€â”€ 004-002-implementation-log.md
â”œâ”€â”€ 005-001-mapper-review-task.md
â”œâ”€â”€ 005-002-architect-review-task.md
â”œâ”€â”€ 005-003-verification-results.json
â”œâ”€â”€ 006-001-developer-fixes-task.md (if needed)
â”œâ”€â”€ 006-002-fixes-applied.md (if needed)
â”œâ”€â”€ 999-001-session-status.md
â””â”€â”€ 999-002-agent-handoffs.json
```

## Format Quick Reference

| Content Type | Format | Extension | Example |
|-------------|--------|-----------|---------|
| Task instructions | Markdown | .md | `001-001-architect-task.md` |
| Documentation | Markdown | .md | `001-002-early-architecture.md` |
| Structured data | JSON | .json | `002-002-interactions.json` |
| Specifications | YAML | .yaml | `003-003-architecture-spec.yaml` |
| Status tracking | Markdown | .md | `999-001-session-status.md` |
| Metadata | JSON | .json | `000-002-session-metadata.json` |
| Verification | JSON | .json | `005-003-verification-results.json` |
| Logs | Markdown | .md | `004-002-implementation-log.md` |
| Code | Language-specific | .js/.py/.go/etc | With agent signature comments |

## Validation Checklist

Before submitting any file, verify:
- [ ] File follows PPP-SSS-name.ext convention
- [ ] Agent signature is present and complete
- [ ] Format matches content type guidelines
- [ ] Metadata includes all required fields
- [ ] If dual-format needed, both files exist
- [ ] Phase number matches current workflow stage
- [ ] Session ID is consistent across related files

## Future Considerations

This guide will evolve as new agent types and workflows are introduced. Potential additions:
- Binary format handling
- Streaming data formats
- Graph/diagram specifications
- Test result formats
- Deployment configuration formats

---
*Last Updated: 2024-08-30*
*Maintained by: Project Optimizer*